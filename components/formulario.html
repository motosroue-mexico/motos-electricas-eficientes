<aside>
    <p class="CBlanco">
        Solicita tu cotización
    </p>
    <h2 class="CBlanco">
        PARA SER DISTRIBUIDOR EXCLUSIVO
    </h2>
</aside>
<div id="mc_embed_shell">
      <link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">
  <style type="text/css">
        #mc_embed_signup{background:#fff; false;clear:left; font:14px Helvetica,Arial,sans-serif; width: 600px;}
        /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
           We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
    <form action="https://deyac.us14.list-manage.com/subscribe/post?u=9534a6efd315bd626253692ec&id=02f9c801cb&f_id=001e8de0f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_self" novalidate="">
        <div id="mc_embed_signup_scroll"><h2>Formulario de registro</h2>
            <div class="indicates-required"><span class="asterisk">*</span> indica que es obligatorio</div>
          <div class="mc-field-group mitad"><label for="mce-EMAIL">Dirección de correo electrónico <span class="asterisk">*</span></label><input type="email" name="EMAIL" class="required email" id="mce-EMAIL" required="" value=""></div>
          <div class="mc-field-group mitad"><label for="mce-FNAME">Nombre y apellido <span class="asterisk">*</span></label><input type="text" name="FNAME" class="required text" id="mce-FNAME" required="" value=""></div>
          <div class="mc-field-group mitad"><label for="mce-PHONE">Número de celular <span class="asterisk">*</span></label><input type="text" name="PHONE" class="REQ_CSS" id="mce-PHONE" value=""></div>
<div class="mc-field-group mitad"><label for="mce-EMPRESA">Nombre de la empresa <span class="asterisk">*</span></label><input type="text" name="EMPRESA" class="required text" id="mce-EMPRESA" required="" value=""></div>
          <div class="mc-field-group"><label for="mce-TIPONEGDIS">¿Qué tipo de negocio tienes? <span class="asterisk">*</span></label><select name="TIPONEGDIS" class="required" id="mce-TIPONEGDIS"><option value=""></option><option value="REFACCIONARIA">REFACCIONARIA</option><option value="TALLER ESPECIALIZADO EN ENFRIAMIENTO">TALLER ESPECIALIZADO EN ENFRIAMIENTO</option><option value="TALLER DE AIRE ACONDICIONADO">TALLER DE AIRE ACONDICIONADO</option><option value="FLOTILLAS">FLOTILLAS</option><option value="TRANSPORTISTA">TRANSPORTISTA</option><option value="GANADERÍA">GANADERÍA</option><option value="AGRICULTURA">AGRICULTURA</option></select></div>
<div class="mc-field-group"><label for="mce-INVERTIR">¿Cuánto planeas invertir mensualmente en inventario para hacer crecer tu negocio como distribuidor de Deyac? <span class="asterisk">*</span></label>
<select name="INVERTIR" class="required" id="mce-INVERTIR">
<option value=""></option>
<option value="$25,000-$50,000">$25,000-$50,000</option>
<option value="$50,000-$75,000">$50,000-$75,000</option>
<option value="$75,000- 100,000">$75,000-$100,000</option>
</select>
</div>
<div class="mc-field-group"><label for="mce-DIRECCION">Dirección </label><input type="text" name="DIRECCION" class=" text" id="mce-DIRECCION" value=""></div>
<div class="mc-field-group mitad"><label for="mce-CIUDAD">Ciudad </label><input type="text" name="CIUDAD" class=" text" id="mce-CIUDAD" value=""></div>
          <div class="mc-field-group mitad"><label for="mce-ESTADO">Estado </label><select name="ESTADO" class="" id="mce-ESTADO"><option value=""></option><option value="Aguascalientes">Aguascalientes</option><option value="Baja California">Baja California</option><option value="Baja California Sur">Baja California Sur</option><option value="Campeche">Campeche</option><option value="Chiapas">Chiapas</option><option value="Chihuahua">Chihuahua</option><option value="Ciudad de México (CDMX)">Ciudad de México (CDMX)</option><option value="Coahuila">Coahuila</option><option value="Colima">Colima</option><option value="Durango">Durango</option><option value="Guanajuato">Guanajuato</option><option value="Guerrero">Guerrero</option><option value="Hidalgo">Hidalgo</option><option value="Jalisco">Jalisco</option><option value="Estado de México">Estado de México</option><option value="Michoacán">Michoacán</option><option value="Morelos">Morelos</option><option value="Nayarit">Nayarit</option><option value="Nuevo León">Nuevo León</option><option value="Oaxaca">Oaxaca</option><option value="Puebla">Puebla</option><option value="Querétaro">Querétaro</option><option value="Quintana Roo">Quintana Roo</option><option value="San Luis Potosí">San Luis Potosí</option><option value="Sinaloa">Sinaloa</option><option value="Sonora">Sonora</option><option value="Tabasco">Tabasco</option><option value="Tamaulipas">Tamaulipas</option><option value="Tlaxcala">Tlaxcala</option><option value="Veracruz">Veracruz</option><option value="Yucatán">Yucatán</option><option value="Zacatecas">Zacatecas</option></select></div>          
<div class="mc-field-group">
<label for="mce-GIRO">¿Cómo podemos ayudarte a crecer como distribuidor de nuestros productos? Cuéntanos qué necesitas. <span class="asterisk">*</span></label>
<textarea type="text" name="GIRO" class="required text" id="mce-GIRO" required="" value="">
</textarea>
</div>
<div hidden=""><input type="hidden" name="tags" value="8101822"></div>
        <div id="mce-responses" class="clear">
            <div class="response" id="mce-error-response" style="display: none;"></div>
            <div class="response" id="mce-success-response" style="display: none;"></div>
        </div><div aria-hidden="true" style="position: absolute; left: -5000px;"><input type="text" name="b_9534a6efd315bd626253692ec_02f9c801cb" tabindex="-1" value=""></div>
          <div class="clear">
            <input type="submit" name="subscribe" id="mc-embedded-subscribe" class="button g-recaptcha" value="Suscribir"  data-sitekey="6Lf6IYsqAAAAAJhaDoHJjVmT7EBejRMo8XHP0ja3" 
        data-callback='onSubmit'
        data-action='submit'>
          </div>
    </div>
</form>
</div>
</div>
<script>
// Función que se llama cuando el reCAPTCHA se completa
function onSubmit(token) {
    // Llamar a la función que maneja el envío del formulario
    handleSubmitForm(token);
}
// Manejar el envío del formulario
function handleSubmitForm(token) {
    // Prevenir el comportamiento por defecto del formulario
    event.preventDefault();
    // Obtener los valores de los campos del formulario
    var email = document.getElementById('mce-EMAIL').value;
    var name = document.getElementById('mce-FNAME').value;
    var phone = document.getElementById('mce-PHONE').value;
    var empresa = document.getElementById('mce-EMPRESA').value;
    var tiponegocio = document.getElementById('mce-TIPONEGDIS').value;
    var necesitas = document.getElementById('mce-GIRO').value;
    var invertir = document.getElementById('mce-INVERTIR').value;
    var direccion = document.getElementById('mce-DIRECCION').value;
    var ciudad = document.getElementById('mce-CIUDAD').value;
    var estado = document.getElementById('mce-ESTADO').value;
     // Validar que todos los campos requeridos tengan información
 if (!email || !name || !phone ||!empresa ||!tiponegocio || !necesitas || !invertir || !direccion|| !ciudad|| !estado) {
console.error('Por favor completa todos los campos requeridos.');
alert('Por favor, completa todos los campos antes de enviar el formulario.');
return; // Detener el envío si falta información
}  
    // URL de Google Apps Script (Asegúrate de usar la URL correcta)
    var googleSheetsUrl = 'https://script.google.com/macros/s/AKfycbzI7qMLv9Mi7RJjA7ZdADekNwNufkFJlRsHLOxC7IbJA2NHSHq1xHkhNeH6uwlWuojyFw/exec';
    // Enviar los datos a Google Sheets
    fetch(googleSheetsUrl, {
        method: 'POST',
        body: new URLSearchParams({
            email: email,
            name: name,
            phone: phone,
            empresa: empresa,
            tiponegocio: tiponegocio,
            necesitas: necesitas,
            invertir: invertir,
            direccion: direccion,
            ciudad: ciudad,
            estado: estado,
        }),
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
    })
        .then((response) => {
            if (!response.ok) {
                console.error("Error al enviar a Google Sheets:", response.statusText);
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            return response.text();
        })
        .then((data) => {
            console.log('Respuesta de Google Sheets:', data);
            // Después de que Google Sheets reciba los datos, enviamos el formulario a Mailchimp
            document.getElementById('mc-embedded-subscribe-form').submit();
        })
        .catch((error) => {
            console.error('Error en la solicitud a Google Sheets:', error);
        });
}
// Opción adicional: si prefieres usar el botón sin reCAPTCHA explícito en el HTML
document.getElementById('mc-embedded-subscribe-form').addEventListener('submit', function(event) {
    event.preventDefault();
    grecaptcha.ready(function() {
        grecaptcha.execute('6Lf6IYsqAAAAAJhaDoHJjVmT7EBejRMo8XHP0ja3', { action: 'submit' }).then(function(token) {
            // Llamar a la función para manejar el formulario después de completar reCAPTCHA
            handleSubmitForm(token);
        });
    });
});
  </script>